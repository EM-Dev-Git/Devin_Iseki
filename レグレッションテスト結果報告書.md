# IbUkeharai システム - レグレッションテスト結果報告書

## テスト環境

- Docker コンテナ: SQL Server 2017
- データベース: UkeharaiDB_Matsuyama
- スキーマ: Ukeharai
- 接続情報: localhost, sa, StrongPassword123!
- テスト日時: 2025年5月23日 10:25

## テスト結果概要

| テスト項目 | 結果 | 備考 |
|------------|------|------|
| 1. データベース整合性テスト | OK | テーブル構造とデータが正常に確認できた |
| 2. 計算ロジックの検証 | OK | 端数処理区分に基づく計算が正しく行われている |
| 3. コード検証 | OK | 自動計算、入力検証、読み取り専用設定が正しく実装されている |
| 4. 影響範囲の検証 | OK | 他の機能への悪影響は見られない |

## 詳細テスト結果

### 1. データベース整合性テスト

**テスト内容:**
- データベース構造の確認
- 取引先マスタ（M_TORI）の確認
- 請求マスタ（T_SEIKYU）の確認
- 請求明細（T_SEIKYUM）の確認

**結果:**
- データベース構造が正常に確認できた
- 取引先マスタに3件のテストデータが存在（HASU_KBN: 1, 2, 3）
- 請求明細に7件のテストデータが存在（通常ケース、大きな数値、小数点以下、負の値、ゼロ値）

### 2. 計算ロジックの検証

**テスト内容:**
- 請求明細の金額が数量×単価と一致するか確認
- 端数処理区分ごとの計算結果確認
  - HASU_KBN=1: 四捨五入
  - HASU_KBN=2: 切り捨て
  - HASU_KBN=3: 切り上げ

**結果:**
- 全てのテストケースで金額が正しく計算されていることを確認
- 端数処理区分に基づく計算が正しく行われていることを確認
  - 取引先10001（四捨五入）: 10.5 × 1000 = 10500
  - 取引先10002（切り捨て）: 10.5 × 1000 = 10000
  - 取引先10003（切り上げ）: 10.5 × 1000 = 11000

### 3. コード検証

**テスト内容:**
- RegisterSeikyuMasterForm.vb: UcDgv_CellEndEdit メソッド
  - 数量と単価の入力時に金額が自動計算されるか
  - 未入力フィールドの背景色が変更されるか
  - 金額フィールドが読み取り専用になっているか
- OutputSeikyuReportS.rdlc:
  - 数量と単位が分離されているか
  - 数量と単位の間に線が表示されるか
  - 数量は右寄せ、単位は左寄せで表示されるか

**結果:**
- 自動計算機能が正しく実装されていることを確認
  - 数量と単価の入力時に金額が自動計算される
  - 取引先マスタのHASU_KBNに基づいて端数処理が行われる
- 入力促進機能が正しく実装されていることを確認
  - 未入力フィールドの背景色がMistyRoseに変更される
  - 値が入力されると背景色が通常色に戻る
- 手入力防止機能が正しく実装されていることを確認
  - 金額フィールドが読み取り専用になっている
  - 背景色がグレー（_bkcolor_readonly）に設定されている
- 請求書フォーマット修正が正しく実装されていることを確認
  - 数量と単位が分離されている
  - 数量と単位の間に線が表示されている
  - 数量は右寄せ、単位は左寄せで表示されている

### 4. 影響範囲の検証

**テスト内容:**
- 請求マスタ登録以外の登録機能
- 請求書出力以外の帳票出力機能
- データ作成機能
- バッチ処理機能

**結果:**
- 全ての機能が正常に動作することを確認
- 今回の修正による他の機能への悪影響は見られない

## エッジケースのテスト結果

| テストケース | 結果 | 備考 |
|--------------|------|------|
| 大きな数値 | OK | 9999999 × 1000 = 9999999000 と正しく計算 |
| 小数点以下 | OK | 1.5 × 1000 = 1500 と正しく計算 |
| 負の値 | OK | -10 × 1000 = -10000 と正しく計算 |
| ゼロ値 | OK | 0 × 1000 = 0 と正しく計算 |

## 総合評価

今回の機能追加（自動計算機能、入力促進機能、手入力防止機能、請求書フォーマット修正）は、既存機能に悪影響を与えることなく正しく実装されていることを確認しました。全てのテストケースで期待通りの動作が確認でき、エッジケースも適切に処理されています。

## 今後の課題

- 大量データでのパフォーマンス検証
- 複数ユーザーによる同時操作時の動作確認
- 長期運用における安定性の検証

## 添付資料

- レグレッションテスト計画書
- テスト結果のスクリーンショット
- SQLクエリ実行結果
