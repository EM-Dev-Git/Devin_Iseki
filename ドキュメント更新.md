# IbUkeharai システム ドキュメント更新

## 1. 概要

本文書は、IbUkeharaiシステムに実装された以下の4つの機能修正に関する既存ドキュメントへの追記情報を提供します。

1. 自動計算機能：数量と単価から金額を自動計算する機能
2. 入力促進機能：未入力フィールドの背景色変更機能
3. 手入力防止機能：金額フィールドの読み取り専用設定
4. 請求書フォーマット修正：数量と単位の分離表示

## 2. 関連ドキュメント

本文書は、以下の既存ドキュメントへの追記情報として位置付けられます。

1. 基本設計書：`/ドキュメント/010.システム全般/井関物流 受払管理システム基本設計書.docx`
2. 操作マニュアル：`/ドキュメント/010.システム全般/■操作マニュアル.docx`
3. 画面定義書（請求マスター登録）：`/ドキュメント/020.画面設計書/受払システム_画面定義書(17.請求マスター登録).xlsx`
4. 画面定義書（請求書出力）：`/ドキュメント/020.画面設計書/受払システム_画面定義書(62.請求書出力).xlsx`

## 3. 機能詳細

### 3.1 自動計算機能

#### 3.1.1 機能概要
請求マスター登録画面（RegisterSeikyuMasterForm）において、数量（SURYO）と単価（TANKA）を入力すると、金額（KINGAKU）が自動的に計算される機能。

#### 3.1.2 操作方法
1. 請求マスター登録画面を開く
2. 数量（SURYO）または単価（TANKA）を入力/変更する
3. 金額（KINGAKU）が自動的に計算される

#### 3.1.3 計算ロジック
- 金額 = 数量 × 単価
- 端数処理は取引先マスタ（M_TORI）の端数処理区分（HASU_KBN）に基づいて行われる
  - HASU_KBN = "1"：四捨五入
  - HASU_KBN = "2"：切り捨て
  - HASU_KBN = "3"：切り上げ

#### 3.1.4 画面定義書への追記
`受払システム_画面定義書(17.請求マスター登録).xlsx`の以下の箇所に追記が必要です：
- 「画面項目一覧」シートの「金額」項目に「数量×単価から自動計算される」旨を追記
- 「画面遷移」シートに「数量または単価の変更時に金額が自動計算される」旨を追記

### 3.2 入力促進機能

#### 3.2.1 機能概要
未入力フィールドの背景色をMistyRoseに変更して入力を促す機能。

#### 3.2.2 操作方法
1. 請求マスター登録画面を開く
2. 数量（SURYO）または単価（TANKA）が未入力の場合、背景色がMistyRoseに変更される
3. 値を入力すると背景色が通常色に戻る

#### 3.2.3 画面定義書への追記
`受払システム_画面定義書(17.請求マスター登録).xlsx`の以下の箇所に追記が必要です：
- 「画面項目一覧」シートの「数量」「単価」項目に「未入力時は背景色がMistyRoseに変更される」旨を追記
- 「画面仕様」シートに「入力促進機能」として説明を追記

### 3.3 手入力防止機能

#### 3.3.1 機能概要
金額（KINGAKU）フィールドを読み取り専用に設定し、手入力を防止する機能。

#### 3.3.2 操作方法
1. 請求マスター登録画面を開く
2. 金額（KINGAKU）フィールドは読み取り専用となっており、直接編集できない
3. 金額は数量と単価から自動計算される

#### 3.3.3 画面定義書への追記
`受払システム_画面定義書(17.請求マスター登録).xlsx`の以下の箇所に追記が必要です：
- 「画面項目一覧」シートの「金額」項目に「読み取り専用」旨を追記
- 「画面仕様」シートに「手入力防止機能」として説明を追記

### 3.4 請求書フォーマット修正

#### 3.4.1 機能概要
請求書レポート（OutputSeikyuReportS.rdlc）において、数量と単位を分離し、間に線を表示する機能。

#### 3.4.2 表示例
```
変更前： 100個
変更後： 100｜個
```

#### 3.4.3 画面定義書への追記
`受払システム_画面定義書(62.請求書出力).xlsx`の以下の箇所に追記が必要です：
- 「帳票レイアウト」シートに「数量と単位の間に縦線を表示する」旨を追記
- 「帳票仕様」シートに「請求書フォーマット修正」として説明を追記

## 4. 操作マニュアルへの追記

`■操作マニュアル.docx`の以下の箇所に追記が必要です：

### 4.1 請求マスター登録
- 「数量と単価を入力すると、金額が自動的に計算されます」
- 「未入力の数量・単価フィールドは背景色がピンク色（MistyRose）で表示されます」
- 「金額フィールドは読み取り専用で、直接編集できません」

### 4.2 請求書出力
- 「請求書の数量と単位の間には縦線が表示されます」

## 5. 基本設計書への追記

`井関物流 受払管理システム基本設計書.docx`の以下の箇所に追記が必要です：

### 5.1 画面機能
- 「請求マスター登録画面」の項目に「自動計算機能」「入力促進機能」「手入力防止機能」の説明を追記

### 5.2 帳票機能
- 「請求書出力」の項目に「請求書フォーマット修正」の説明を追記

## 6. 改定履歴

| 日付 | 版数 | 改定者 | 改定内容 |
|------|------|--------|----------|
| 2025/05/22 | 1.0 | 松岡 | 新規作成 |
