# 生産受払システム機能追加 - テスト計画書

## テスト環境

- Visual Studio 2017以降
- .NET Framework 4.6
- SQL Server 2017（UkeharaiDB_Matsuyama）

## テスト前の準備

1. Visual Studioで`IbUkeharai.sln`を開く
2. `Config.xml`の接続設定が正しいことを確認
3. デバッグ実行（F5）でアプリケーションを起動

## テスト項目

### 1. 自動計算機能のテスト

**テスト手順：**
1. メインメニューから「請求マスタ登録」を選択
2. 取引先を選択し、「照会」ボタンをクリック
3. 「行追加」ボタンをクリックして新しい行を追加
4. 以下の操作を行い、結果を確認：
   - 数量（SURYO）に値を入力し、別のセルに移動
   - 単価（TANKA）に値を入力し、別のセルに移動
   - 金額（KINGAKU）が自動計算されることを確認（SURYO × TANKA）

**期待結果：**
- 数量と単価を入力すると、金額が自動的に計算される
- 計算は取引先マスタの端数処理区分（HASU_KBN）に基づいて行われる

### 2. 入力促進機能のテスト

**テスト手順：**
1. メインメニューから「請求マスタ登録」を選択
2. 取引先を選択し、「照会」ボタンをクリック
3. 「行追加」ボタンをクリックして新しい行を追加
4. 以下の操作を行い、結果を確認：
   - 数量（SURYO）を空のままにして別のセルに移動
   - 単価（TANKA）を空のままにして別のセルに移動
   - 単位（TANI）を空のままにして別のセルに移動

**期待結果：**
- 未入力のセルの背景色がピンク色（MistyRose）に変わる
- 値を入力すると背景色が通常色に戻る

### 3. 手入力防止機能のテスト

**テスト手順：**
1. メインメニューから「請求マスタ登録」を選択
2. 取引先を選択し、「照会」ボタンをクリック
3. 「行追加」ボタンをクリックして新しい行を追加
4. 金額（KINGAKU）フィールドをクリックして編集を試みる

**期待結果：**
- 金額フィールドが読み取り専用になっており、編集できない
- 金額フィールドの背景色がグレー（_bkcolor_readonly）になっている

### 4. 請求書フォーマット修正のテスト

**テスト手順：**
1. メインメニューから「請求書出力」を選択
2. 取引先と請求年月を選択
3. 「照会」ボタンをクリック
4. 「印刷」ボタンをクリックしてプレビューを表示

**期待結果：**
- 請求書の明細部分で、数量と単位が分離されている
- 数量と単位の間に縦線が表示されている
- 数量は右寄せ、単位は左寄せで表示されている

## テスト結果記録

| テスト項目 | 結果（OK/NG） | 備考 |
|------------|--------------|------|
| 1. 自動計算機能 |  |  |
| 2. 入力促進機能 |  |  |
| 3. 手入力防止機能 |  |  |
| 4. 請求書フォーマット修正 |  |  |

## 追加テスト（エッジケース）

1. **大きな数値の処理：**
   - 非常に大きな数値（例：9999999）を数量と単価に入力し、計算が正しく行われるか確認

2. **小数点以下の処理：**
   - 小数点以下の値（例：1.5）を数量に入力し、計算と表示が正しく行われるか確認

3. **負の値の処理：**
   - 負の値（例：-10）を数量に入力し、計算と表示（赤色表示）が正しく行われるか確認

4. **ゼロ値の処理：**
   - 数量または単価にゼロを入力し、計算が正しく行われるか確認

## 注意事項

- テスト実行前にデータベースのバックアップを取ることを推奨
- テストデータは本番環境に影響を与えないよう注意
- 問題が発生した場合は、エラーメッセージと再現手順を記録
